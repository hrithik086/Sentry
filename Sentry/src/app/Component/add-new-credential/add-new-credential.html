<div class="modal-overlay">
  <div class="modal-card">
    <div class="card-header">
      <h2>Add New Credential</h2>
      <button class="close-btn" aria-label="Close" (click)="closeCard()">
        <span>&times;</span>
      </button>
    </div>

    <form [formGroup]="credentialForm" (ngSubmit)="onSubmit()" class="card-form">
      <div class="form-section">
        <h3>Basic Details</h3>
        
        <div class="form-group">
          <label for="domainName" class="form-label">Domain Name <span class="required">*</span></label>
          <input
            id="domainName"
            type="text"
            class="form-input"
            placeholder="e.g., gmail.com"
            formControlName="domainName"
          />
          <div class="error-message" *ngIf="isFieldInvalid('domainName')">
            Domain name is required
          </div>
        </div>

        <div class="form-group">
          <label for="userId" class="form-label">Username/Email <span class="required">*</span></label>
          <input
            id="userId"
            type="text"
            class="form-input"
            placeholder="Enter your username or email"
            formControlName="userId"
          />
          <div class="error-message" *ngIf="isFieldInvalid('userId')">
            Username/Email is required
          </div>
        </div>

        <div class="form-group">
          <label for="password" class="form-label">Password <span class="required">*</span></label>
          <input
            id="password"
            type="password"
            class="form-input"
            placeholder="Enter password"
            formControlName="password"
          />
          <div class="error-message" *ngIf="isFieldInvalid('password')">
            Password is required
          </div>
        </div>
      </div>

      <div class="form-section">
        <h3>Additional Details</h3>

        <div class="form-group">
          <label for="pin" class="form-label">PIN <span class="optional">(optional)</span></label>
          <input
            id="pin"
            type="password"
            class="form-input"
            placeholder="Enter PIN if applicable"
            formControlName="pin"
          />
        </div>

        <div class="form-group">
          <label for="securityKeys" class="form-label">Security Keys <span class="optional">(optional)</span></label>
          <input
            id="securityKeys"
            type="text"
            class="form-input"
            placeholder="Enter security keys or recovery codes"
            formControlName="securityKeys"
          />
        </div>
      </div>

      <div class="form-section">
        <h3>Other Details <span class="optional">(optional)</span></h3>
        <p class="section-hint">Add any additional credential information</p>
        
        <div formArrayName="otherDetails">
          <div *ngFor="let control of otherDetailsArray().controls; let i = index" [formGroupName]="i" class="other-details-group">
            <button type="button" class="remove-btn" (click)="removeOtherDetail(i)" aria-label="Remove this detail">
              Remove
            </button>
            
            <div class="form-group">
              <label [for]="'informationType-' + i" class="form-label">Information Type</label>
              <input
                [id]="'informationType-' + i"
                type="text"
                class="form-input"
                placeholder="e.g., Security Question, Recovery Email"
                formControlName="informationType"
              />
            </div>

            <div class="form-group">
              <label [for]="'otherKey-' + i" class="form-label">Key</label>
              <input
                [id]="'otherKey-' + i"
                type="text"
                class="form-input"
                placeholder="e.g., Question, Email"
                formControlName="key"
              />
            </div>

            <div class="form-group">
              <label [for]="'otherValue-' + i" class="form-label">Value</label>
              <input
                [id]="'otherValue-' + i"
                type="text"
                class="form-input"
                placeholder="Enter the value"
                formControlName="value"
              />
            </div>
          </div>
        </div>

        <button type="button" class="add-field-btn" (click)="addOtherDetail()">
          + Add Another Detail
        </button>
      </div>

      <div class="form-actions">
        <button type="button" class="btn-cancel">Cancel</button>
        <button type="submit" class="btn-submit" [disabled]="credentialForm.invalid">
          Save Credential
        </button>
      </div>
    </form>
  </div>
</div>
